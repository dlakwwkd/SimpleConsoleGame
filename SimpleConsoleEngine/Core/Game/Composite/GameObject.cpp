#include "stdafx.h"
#include "GameObject.h"
#include "GameObjectImpl.hpp"
#include "../../Math/Vec2.h"
SCE_USE

/////////////////////////////////////////////////////////////////////////////////////////
GameObject::GameObject() noexcept
    : pimpl{ std::make_unique<impl>() }
{
}

/////////////////////////////////////////////////////////////////////////////////////////
GameObject::~GameObject()
{
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::Init()
{
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::Release()
{
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::Update(float _dt)
{
    pimpl->MovePowerFixInLimit();
    pimpl->pos += pimpl->movePower * (pimpl->speed / pimpl->movePowerLimit * _dt);  // 현재 속도만큼 이동
    pimpl->movePower -= pimpl->movePower * (pimpl->movePowerFrict * _dt);           // 마찰로 인한 속력 저하
    //pimpl->PosFixInScreanBoundary();
}

/////////////////////////////////////////////////////////////////////////////////////////
Vec2 GameObject::GetPos() const noexcept
{
    return pimpl->pos;
}

/////////////////////////////////////////////////////////////////////////////////////////
Vec2 GameObject::GetDirection() const noexcept
{
    return pimpl->dir;
}

/////////////////////////////////////////////////////////////////////////////////////////
float GameObject::GetMovePowerLimit() const noexcept
{
    return pimpl->movePowerLimit;
}

/////////////////////////////////////////////////////////////////////////////////////////
float GameObject::GetMovePowerFrict() const noexcept
{
    return pimpl->movePowerFrict;
}

/////////////////////////////////////////////////////////////////////////////////////////
float GameObject::GetSpeed() const noexcept
{
    return pimpl->speed;
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::SetPos(const Vec2& _pos) noexcept
{
    pimpl->pos = _pos;
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::SetDirection(const Vec2& _dir) noexcept
{
    pimpl->dir = _dir;
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::SetMovePower(const Vec2& _power) noexcept
{
    pimpl->movePower = _power;
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::AddMovePower(const Vec2& _addPower) noexcept
{
    pimpl->movePower += _addPower;
    pimpl->dir = pimpl->movePower.GetNormalized();
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::SetMovePowerLimit(float _ratio) noexcept
{
    pimpl->movePowerLimit = _ratio;
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::SetMovePowerFrict(float _ratio) noexcept
{
    pimpl->movePowerFrict = _ratio;
}

/////////////////////////////////////////////////////////////////////////////////////////
void GameObject::SetSpeed(float _speed) noexcept
{
    pimpl->speed = _speed;
}

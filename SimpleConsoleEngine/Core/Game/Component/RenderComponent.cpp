#include "stdafx.h"
#include "RenderComponent.h"
#include "../../Console/Coord.h"
#include "../../Console/Shape.h"
SCE_USE

_identifier IComponentCRTP<RenderComponent>::s_Identifier;

/////////////////////////////////////////////////////////////////////////////////////////
struct RenderComponent::impl
{
    impl(const CompositeRef& _owner) noexcept
        : owner{ _owner }
        , isShow{ true }
        , depth{}
        , coord{}
        , shape{}
    {
    }

    CompositeRef    owner;
    bool            isShow;
    BYTE            depth;
    Coord           coord;
    Shape           shape;
};

/////////////////////////////////////////////////////////////////////////////////////////
RenderComponent::RenderComponent(const CompositeRef& _owner) noexcept
    : pimpl{ std::make_unique<impl>(_owner) }
{
}

/////////////////////////////////////////////////////////////////////////////////////////
RenderComponent::~RenderComponent()
{
}

/////////////////////////////////////////////////////////////////////////////////////////
std::string RenderComponent::GetComponentName() const
{
    return TO_STRING(RenderComponent);
}

/////////////////////////////////////////////////////////////////////////////////////////
IComponent::CompositePtr RenderComponent::GetOwner() const
{
    return pimpl->owner.lock();
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::Render()
{
    if (pimpl->isShow)
    {
        pimpl->shape.Render(pimpl->coord, pimpl->depth);
    }
}

/////////////////////////////////////////////////////////////////////////////////////////
bool RenderComponent::IsShow() const noexcept
{
    return pimpl->isShow;
}

/////////////////////////////////////////////////////////////////////////////////////////
BYTE RenderComponent::GetDepth() const noexcept
{
    return pimpl->depth;
}

/////////////////////////////////////////////////////////////////////////////////////////
const Coord& RenderComponent::GetCoord() const noexcept
{
    return pimpl->coord;
}

/////////////////////////////////////////////////////////////////////////////////////////
const Shape& RenderComponent::GetShape() const noexcept
{
    return pimpl->shape;
}

/////////////////////////////////////////////////////////////////////////////////////////
wchar_t RenderComponent::GetForm() const noexcept
{
    return pimpl->shape.form;
}

/////////////////////////////////////////////////////////////////////////////////////////
Color RenderComponent::GetColor() const noexcept
{
    return pimpl->shape.color;
}

/////////////////////////////////////////////////////////////////////////////////////////
Color RenderComponent::GetBGColor() const noexcept
{
    return pimpl->shape.bgColor;
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::SetShow(bool _isShow) noexcept
{
    pimpl->isShow = _isShow;
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::SetDepth(BYTE _depth) noexcept
{
    pimpl->depth = _depth;
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::SetCoord(const Coord& _coord) noexcept
{
    pimpl->coord = _coord;
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::SetCoord(short _x, short _y) noexcept
{
    pimpl->coord.x = _x;
    pimpl->coord.y = _y;
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::SetShape(const Shape& _shape) noexcept
{
    pimpl->shape = _shape;
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::SetShape(wchar_t _form) noexcept
{
    pimpl->shape.form = _form;
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::SetColor(Color _color) noexcept
{
    pimpl->shape.color = _color;
}

/////////////////////////////////////////////////////////////////////////////////////////
void RenderComponent::SetBGColor(Color _bgColor) noexcept
{
    pimpl->shape.bgColor = _bgColor;
}
